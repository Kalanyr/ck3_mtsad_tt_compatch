namespace = mz_religious_decision

#########################
# Reforming Kabarism	#
# by James Beaumont		#
#########################

mz_religious_decision.0001 = {
	type = character_event
	title = religious_decision.0501.t
	desc = {
		desc = religious_decision.0501.desc
	}
	theme = faith
	override_background = {
		reference = temple_generic
	}
	left_portrait = root
	right_portrait = root.faith.religious_head
	
	immediate = {
		save_scope_as = khazar_khan
	}

	option = {
		name = religious_decision.0501.a
		stress_impact = {
			zealous = major_stress_impact_gain
			cynical = minor_stress_impact_loss
		}
		root.faith.religious_head = {
			add_opinion = {
				target = root
				modifier = insult_opinion
				opinion = -40
			}
		}
		every_vassal = {
			custom = religious_decision.0501.jewish.tt
			limit = {
				has_religion = religion:judaism_religion
			}
			add_opinion = {
				target = root
				modifier = disappointed_opinion
				opinion = -10
			}
		}
		every_vassal = {
			custom = religious_decision.0501.nonjewish.tt
			limit = {
				NOT = { has_religion = religion:judaism_religion }
			}
			add_opinion = {
				target = root
				modifier = pleased_opinion
				opinion = 30
			}
		}
	}

	option = {
		name = religious_decision.0501.b
		ai_chance = {
			base = 100 #the AI should always pick this one
		}
		stress_impact = {
			zealous = minor_stress_impact_loss
		}
		root.faith = {
			remove_doctrine = tenet_adaptive
			remove_doctrine = tenet_unreformed_syncretism
			add_doctrine = doctrine_mz_no_syncretism
			add_doctrine = tenet_esotericism
			remove_doctrine = doctrine_pluralism_pluralistic
			add_doctrine = doctrine_pluralism_righteous
		}
		every_vassal = {
			custom = religious_decision.0501.nonjewish.tt
			limit = {
				NOT = { has_religion = religion:judaism_religion }
			}
			add_opinion = {
				target = root
				modifier = disappointed_opinion
				opinion = -10
			}
		}
		hidden_effect = {
			every_ruler = {
				limit = {
					OR = {
						is_vassal_of = root
						has_faith = faith:kabarism
					}
				}
				trigger_event = mz_middle_east_decisions.0003
			}
		}
	}

	option = {
		name = religious_decision.0501.c
		stress_impact = {
			zealous = major_stress_impact_loss
			gregarious = minor_stress_impact_gain
		}
		root.faith = {
			remove_doctrine = tenet_unreformed_syncretism
			add_doctrine = doctrine_mz_no_syncretism
			remove_doctrine = tenet_adaptive
			add_doctrine = tenet_armed_pilgrimages
			remove_doctrine = doctrine_pluralism_pluralistic
			add_doctrine = doctrine_pluralism_fundamentalist
		}
		every_vassal = {
			custom = religious_decision.0501.nonjewish.tt
			limit = {
				NOT = { has_religion = religion:judaism_religion }
			}
			add_opinion = {
				target = root
				modifier = scared_opinion
				opinion = -25
			}
		}
		every_vassal = {
			limit = {
				has_religion = religion:judaism_religion
			}
			custom = religious_decision.0501.jewish.tt
			add_opinion = {
				target = root
				modifier = respect_opinion
				opinion = 20
			}
		}
		hidden_effect = {
			every_ruler = {
				limit = {
					NOT = { this = root }
					OR = {
						is_vassal_of = root
						has_faith = faith:kabarism
					}
				}
				trigger_event = mz_religious_decision.0002
			}
		}
	}
}

#Event notifying vassals and Kabarites of the changes
mz_religious_decision.0002 = {
	type = character_event
	title = religious_decision.0502.t
	desc = {
		desc = religious_decision.0502.desc.intro
		desc = religious_decision.0502.desc.body
		triggered_desc = {
			trigger = {
				scope:khazar_khan.faith = {
					NOT = {
						has_doctrine = doctrine_pluralism_fundamentalist
					}
				}
			}
			desc = religious_decision.0502.desc.righteous
		}
		triggered_desc = {
			trigger = {
				scope:khazar_khan.faith = {
					has_doctrine = doctrine_pluralism_fundamentalist
				}
			}
			desc = religious_decision.0502.desc.fundamentalist
		}
	}
	theme = faith
	override_background = {
		reference = temple_generic
	}
	left_portrait = scope:khazar_khan
	right_portrait = root

	option = {
		name = religious_decision.0502.a
		trigger = {
			NOT = { has_faith = faith:kabarism }
			scope:khazar_khan.faith = {
				NOT = {
					has_doctrine = doctrine_pluralism_fundamentalist
				}
			}
		}
		ai_chance = {
			base = 10
		}
		show_as_tooltip = {
			scope:khazar_khan.faith = {
				remove_doctrine = tenet_adaptive
				remove_doctrine = tenet_unreformed_syncretism
				add_doctrine = doctrine_mz_no_syncretism
				add_doctrine = tenet_esotericism
				remove_doctrine = doctrine_pluralism_pluralistic
				add_doctrine = doctrine_pluralism_righteous
			}
		}
	}

	option = {
		name = religious_decision.0502.a
		trigger = {
			NOT = { has_faith = faith:kabarism }
			scope:khazar_khan.faith = { has_doctrine = doctrine_pluralism_fundamentalist }
		}
		show_as_tooltip = {
			scope:khazar_khan.faith = {
				remove_doctrine = tenet_unreformed_syncretism
				add_doctrine = doctrine_mz_no_syncretism
				remove_doctrine = tenet_adaptive
				add_doctrine = tenet_armed_pilgrimages
				remove_doctrine = doctrine_pluralism_pluralistic
				add_doctrine = doctrine_pluralism_fundamentalist
			}
		}
	}

	option = {
		name = religious_decision.0502.b
		trigger = {
			has_faith = faith:kabarism
			scope:khazar_khan.faith = {
				NOT = {
					has_doctrine = doctrine_pluralism_fundamentalist
				}
			}
		}
		ai_chance = {
			base = 10
		}
		show_as_tooltip = {
			scope:khazar_khan.faith = {
				remove_doctrine = tenet_adaptive
				remove_doctrine = tenet_unreformed_syncretism
				add_doctrine = doctrine_mz_no_syncretism
				add_doctrine = tenet_esotericism
				remove_doctrine = doctrine_pluralism_pluralistic
				add_doctrine = doctrine_pluralism_righteous
			}
		}
	}

	option = {
		name = religious_decision.0502.b
		trigger = {
			has_faith = faith:kabarism
			scope:khazar_khan.faith = { has_doctrine = doctrine_pluralism_fundamentalist }
		}
		show_as_tooltip = {
			scope:khazar_khan.faith = {
				remove_doctrine = tenet_unreformed_syncretism
				add_doctrine = doctrine_mz_no_syncretism
				remove_doctrine = tenet_adaptive
				add_doctrine = tenet_armed_pilgrimages
				remove_doctrine = doctrine_pluralism_pluralistic
				add_doctrine = doctrine_pluralism_fundamentalist
			}
		}
	}
}